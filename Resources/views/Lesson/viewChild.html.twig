{% macro recursiveChapter(root, chapter, lesson, isRoot) %}
    {% if isRoot %}
        <ul class='jquery-sortable-list list-group menu' id = '{{ root.id }}'>
    {% else %}
        <ul class='' id = '{{ root.id }}'>
    {% endif %}
    {% if root.__children|length %}
        {% for child in root.__children %}
            <li id = '{{ child.id }}' data-path = '{{ path('icap_lesson_move_chapter', { 'resourceId': lesson.id, 'chapterId': child.id })}}' >
            {% if child.id == chapter.id %}
                <div class='menu-item active'>
            {% else %}
                <div class='menu-item'>
            {% endif %}
                <i class="icon-move"></i><a href="{{ path('icap_lesson_chapter', { 'resourceId': lesson.id, 'chapterId': child.id }) }}">{{ child.title }}</a>
            </div>
            {{ _self.recursiveChapter(child, chapter, lesson, false) }}
            </li>
        {% endfor %}
    {% endif %}
    </ul>
{% endmacro %}

{% if tree is defined and tree != null and tree.__children is defined and tree.__children|length %}
    <div>
        {{ _self.recursiveChapter(tree, chapter, _resource, true) }}
        <form id='moveform' action ='' method='post' style='display:none;'>
            {{ form_rest(form) }}
           {# {{ form_row(form._token) }}#}
        </form>
    </div>
{% else %}
    {{ 'There is no chapter'|trans({}, 'icap_lesson') }}
{% endif %}